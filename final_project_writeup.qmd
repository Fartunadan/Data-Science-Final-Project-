---
title: "Rent Burden in Florida"
author: "Daija, Fartun, Kaela"
format: html
embed-resources: true
execute:
  warning: false
  message: false
  echo: false
editor: visual
---

# Predicting Rent Burden In Florida

```{r}
#| echo: false 
knitr::include_graphics("image01.avif")
```

## Problem Statement:

Housing affordability has reached a critical juncture for American renters.

-   Between 2021 and 2023, the number of cost-burdened renter households those spending more than 30% of their income on rent and utilities climbed to an unprecedented 22.6 million, with 12.1 million households severely burdened by spending over half their income on housing.

-   Nearly half of all renter households now face cost burden, and these impacts fall disproportionately across racial lines, exacerbating existing inequalities.

Florida residents experience particularly high levels of rent burden with a median gross rent as percentage of income at 34.5 percent, the highest in the country. Additionally, we can see from the map below that in some counties, the median rent as a percentage of income is upwards of 40 percent. With a statewide ban on rent stabilization, increased migration from northern states, and a housing construction market unable to keep up with demand, policymakers are preparing for even greater constraints on affordable housing by 2034. This escalating crisis threatens not only individual financial stability but also broader economic health, as families sacrifice spending on healthcare, education, and savings to maintain shelter. Understanding the drivers and patterns of rent burden is essential to proper policy and preparation.

```{r}
library(tidyverse)
library(tidymodels)
library(rpart.plot)
library(vip)
library(haven)
library(dotenv)
library(tidycensus)

load_dot_env()

credential <- Sys.getenv("census_api_key")

get_acs(
  geography = "county",
  variables = "B25071_001E",
    geometry = TRUE,
    year = 2023,
    output = "wide",
    state = 12,
    key = credential) |>
ggplot() +
  geom_sf(mapping = aes(fill = B25071_001E)) +
  scale_fill_gradient(
    low = "lightyellow",
    high = "darkred",
    name = "Median Rent as % of Income"
  ) +
  labs(title = "Median Rent as a % of Household Income in Florida by County, 2023") +
  theme_void()

```

Our targeting intervention project aims to provide an evidence based prediction tool to support resource allocation decision making at county and state levels. A predictive model addressing rent burden can identify at-risk populations and forecast future trends to inform policies that prevent more households from falling into financial precarity. Without such tools, Florida's responses will remain reactive rather than preventive, leaving vulnerable communities increasingly exposed to housing instability and its cascading consequences.

## Research Question: Predicting Household Rent Burden

**Primary Research Question:** Can we develop a model that adequately predicts a household's rent burden status using socioeconomic and demographic characteristics?

**Secondary Research Question:** Which variables are the most important in predicting the extent to which a household is rent burdened?

*Model Development:*

-   What combination of socioeconomic and demographic factors best predicts rent burden status?

-   How accurately can we classify households into burden categories (not burdened, burdened, severely burdened)?

-   Which modeling approaches (decision tree or elastic net) provide optimal predictive performance?

## Data Set Description and Data Preparation

The data were pulled from the IPUMS American Community Survey (ACS) 2023 microdata. The sample was limited to individuals who reported renting their dwelling and having positive household income, ensuring that rent burden could be meaningfully calculated. The data were further restricted to households located in Florida. Variables related to survey design, sampling identifiers, and other non-essential fields were removed to streamline the dataset for analysis.

To construct household-level characteristics, individual-level records were grouped by household identifier (serial). Within each household, several proportional and summary measures were created, including the proportion of female household members, average age, proportion of adults, healthcare coverage status, racial and ethnic composition, citizenship status, educational attainment, employment participation, and total weekly hours worked. These variables capture household composition and socioeconomic conditions that may be associated with rent burden. After these features were generated, the data were collapsed to the household level by retaining only information for the head of household, while individual-level demographic variables were removed.

Rent burden measures were constructed using gross monthly rent and household income. An annualized rent-to-income ratio was calculated, from which two outcomes were derived: a binary rent burden indicator indicating that a household was rent burdened if rent exceeded 30% of income, and a three-category ordered factor variable distinguishing **not rent burdened**, **rent burdened** (30–50%), and **severely rent burdened** (over 50%). The categorical outcome variable was explicitly ordered to reflect increasing levels of financial strain. Several remaining variables were converted to factors, educational attainment was treated as an ordered factor, and household survey weights were designated using frequency weights (hhwt). Finally, variables used directly to construct the rent burden outcomes (rent and income measures) were removed as they would perfectly predict our outcomes.

The resulting dataset (acs_florida) represents a clean, household-level analytic file suitable for modeling rent burden among Florida renter households.

## Training–Testing Data Split and Exploratory Analysis of the Training Data

After constructing the final household-level dataset, the data were split into training and testing subsets to support model development and evaluation. Using a fixed random seed (set.seed(30061825)) ensured that the split was reproducible. We randomly split to allocate **75% of the observations to the training set** and the remaining **25% to the testing set**. The training data were used to fit and tune the models, while the testing data were held out to provide an unbiased assessment of model performance on unseen data.

#### Visualization 1: Distribution of Rent Burden in Training Data (Outcome Variable)

```{r}
library(tidyverse)
library(tidymodels)
library(rpart.plot)
library(vip)
library(haven)

acs_florida <- read_csv("data/acs_florida.csv")

acs_florida <- acs_florida |>
  mutate(across(c(rent_burden, hhtype, cbhhtype, countyfip, metro, city, marst), ~ factor(.x, ordered = FALSE)),
         educd = factor(educd, ordered = TRUE),
         hhwt = frequency_weights(hhwt),
         rent_burdend = factor(rent_burdend, levels = c("severely rent burdened", "rent burdened", "not rent burdened"), ordered = TRUE))

set.seed(30061825)

florida_split <- initial_split(data = acs_florida, prop = 0.75)

florida_train <- training(x = florida_split)
florida_test <- testing(x = florida_split)

florida_train |>
  count(rent_burdend) |>
  ggplot(aes(x = rent_burdend, y = n, fill = rent_burdend)) +
  geom_col() +
  labs(
    title = "Distribution of Rent Burden Among Florida Renter Households",
    x = "Rent Burden Category",
    y = "Number of Households"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```

The bar chart shows the distribution of rent burden categories among Florida renter households in the training dataset. The largest group consists of households that are not rent burdened, indicating that a substantial portion of renters spend less than 30% of their income on housing. However, a considerable number of households fall into the rent burdened and extremely rent burdened categories, with the extremely rent burdened group slightly larger than the rent burdened group. This distribution highlights that housing affordability is a significant issue for many renters in Florida and suggests a meaningful class imbalance that should be considered when modeling rent burden outcomes.

#### Visualization 2: Density Plot: Age Distribution of Rent-Burdened vs Non-Rent Burdened

```{r}
florida_train |>
  ggplot(aes(x = mean_age, fill = factor(rent_burden))) +
  geom_density(alpha = 0.6) +
  scale_fill_manual(values = c("0" = "lightblue", "1" = "plum"),
                    labels = c("0" = "not rent burdened", "1" = "rent burdened")) +
  labs(title = "Age Distribution: Rent-Burdened vs Non-Rent-Burdened (Density)",
       x = "Mean Household Age",
       y = "Density",
       fill = "Status") +
  theme_minimal()
```

This density plot shows the distribution of mean household age among rent-burdened and non-rent-burdened Florida households in 2023 in our training data. Both distributions are right skewed with peaks in around age 25 and later between ages 60 and 70. We see a high concentration of younger households in the rental market and proportional overlap between the curves across all ages, suggesting that age alone does not differentiate between those households that are rent-burdened and those that are not. There is a notable difference between the second peaks of the two curves, where rent-burdened households are more concentrated around the age of 65 than non-rent burdened households. This aligns with expectations given the older demographic of Florida retirees that rely on fixed income.

Overall, the density curves reveal that rent-burdened and not rent-burdened households follow similar age distributions, suggesting age alone does not differentiate between rent-burdened and not.

## Model Selection

We decided to create three different models, a decision tree with the binary rent burden indicator as the outcome variable, a decision tree with the three categories factor variable, and a parametric classification model with the factor variable. We wanted to compare a non-parametric model (decision tree) and a parametric model (elastic net). We believe that decision trees provide greater ease of interpretation, and we wanted to assess the trade-off between interpretability and model complexity in improving targeting precision. We considered using a continuous variable predicting rent as a proportion of household income. However, we decided to focus on classification with clear thresholds that are relevant to policy makers.

The elastic net model combines L1 (lasso) and L2 (ridge) regularization to handle multicollinearity and select important features. We chose an elastic net model due to its ability to perform well with datasets that have multicollinearity and a mix of categorical and numeric variables.

## Model Performance

### Model 1: Decision Tree with dummy variable

```{r}
knitr::include_graphics("model1matrix.png")
```

Our first model uses the decision tree algorithm with two categories, rent burdened or not rent burdened. We tuned the model for cost complexity, tree depth, and the minimum number of observations is a terminal node, and used 5 fold cross validation. We choose the combination of values for the hyperparameters based on model precision before fitting it to the training data. The hyper parameters associated with the model with the lowest precision were cost complexity = 0.00001, tree depth = 3, and min n = 2.

The final model selected for this decision tree with a binary outcome variable achieved a precision of 64.8% and an accuracy of 70.5%. Ideally, precision and accuracy would be above 70% for this to be a decent model. The model identifies total hours worked as the root node. Total work hours is defined as a normalized sum of usual work hours across the sample. Since we normalized all numeric predictors in our model, we are unable to assess the corresponding threshold where the tree splits. However, households with total hours worked above that threshold are predicted not to be rent burdened. Otherwise, the household is rent burdened. This outcome suggests that households that work more hours in total are less likely to experience rent burden than those households that work less.

```{r}
knitr::include_graphics("model1dt.png")
```

### Model 2: Decision tree with factor variable

```{r}
knitr::include_graphics("model2matrix.png")
```

For the second model, we similarly use a decision tree to predict rent burden status. However, here we use the factor variable with rent burden categories: not rent burdened, rent burdened, and severely rent burdened. As we did with the first model, we perform tuning on all three hyperparameters and set up resampling for cross validation. The model with the lowest precision had the following values for each hyperparameter: cost complexity = 0.1, tree depth = 3, and min n = 2.

This decision tree with our three level categorical outcome had a precision of 54% and an accuracy of 51.4%, much lower than the model with the binary outcome variable. This model also determined its root node based on total hours worked. However, during cross-validation, warnings occurred because the model failed to predict certain outcome categories, specifically “rent burdened” and “severely rent burdened” in several resampling folds.

This issue is further illustrated in the confusion matrix, where the model never predicts the “rent burdened” category and heavily favors the “severely rent burdened” and “not rent burdened” classes. This pattern suggests that the model struggles to distinguish between intermediate rent burden categories. The model's inability to predict all three categories and its lower precision and accuracy suggest that it will not be useful for implementation purposes.

```{r}
knitr::include_graphics("model2dt.png")
```

### Model 3: Elastic net with factor variable

```{r}
knitr::include_graphics("modelmatrix.png")
```

Our final model is an Elastic Net multinomial regression model, also developed to predict the three category factor variable. The model was tuned by optimizing two key hyperparameters: penalty and mixture, which control the strength and balance of L1 (Lasso) and L2 (Ridge) regularization. As above, hyperparameter tuning was conducted using cross-validation with a grid, and model performance was evaluated using precision. Once we selected the best-performing model, we finalized it and fit it to the full training data. For this model, the penalty was tuned to 0.0000000001 and the mixture was tuned to 0, suggesting that ridge was the best performing model.

The final elastic net model achieved an accuracy of 56.1% and a precision of 51.5%, which is a similar predictive performance as the decision tree model with the factor variable. Just as with the second model, the elastic net model failed to predict the "rent burdened" category at all. These results suggest that elastic net, at least with a multi-class outcome variable, does not provide the strongest overall performance for accurately classifying rent burden status.

## Analysis

```{r}

```

## Findings/Results

## Conclusions and Recommendations

-   Analysis of best model

-   variable importance and compare accuracy and precision on testing data to training data (Daija's model)

Conclusion and Recommendations
